---
title: "Practical 2 Worksheet"
output: html_document
---

Use this workspace to complete the Visualization Practical. 

---

Install Packages if needed:
```{r}
install.packages("tidyverse")
install.packages("ISLR")
```

Load packages in the local library:
```{r}
library(tidyverse)
library(ISLR)
```

---


Copy and Paste each code block here:
```{r}
head(Hitters)
hist(Hitters$Salary, xlab = "Salary in thousdands of dollars")
barplot(table(Hitters$League)) #plots the amount of members in the league

plot(x = Hitters$Hits, y = Hitters$HmRun, 
     xlab = "Hits", ylab ="Home Runs") #Plots the number of career home runs vs number of 1986 home runs

```


```{r}
homeruns_plot <- 
  ggplot(Hitters, aes(x = Hits, y = HmRun)) +
  geom_point() +
  labs(x = "Hits", y = "Home runs")

homeruns_plot

homeruns_plot + 
  geom_density_2d() +
  labs(title = "Cool density and scatter plot of baseball data") +
  theme_minimal()


```
---

**Question 1: Run the following code examples, and identify which is the most easily understood.**

---
```{r}
dia.ex1 <- ggplot(data = diamonds, mapping = aes(x = price, y = carat)) +
  geom_point() + 
  labs(x = "Price in USD", y = "Carat", title = "Price of Diamond by Carat") + 
  theme_classic()

dia.ex1


dia.ex2 <- ggplot(data = diamonds, mapping = aes(x = price, y = carat,
                                                            colour = cut)) +
  geom_point(shape=1) + 
  labs(x = "Price in USD", y = "Carat", title = "Price of Diamond by Carat") + 
  theme_minimal()

dia.ex3 <- dia.ex2 + facet_grid(cols = vars(diamonds$cut))

dia.ex2

dia.ex3



```



---

**Question 2a: Using your knowledge and understanding of what makes a good, clear graph, improve the graph which you consider to be the worst.**

---

Copy and Paste your code here and edit accordingly
```{r}
dia.ex1good <- ggplot(data = diamonds, mapping = aes(x = price, y = carat, color = cut)) +
  geom_point(shape=16) + 
  labs(x = "Price in USD", y = "Carat", title = "Price of Diamond by Carat") + 
  theme_minimal()

dia.ex1good

dia.ex1gooder <- dia.ex1good + facet_grid(cols = vars(diamonds$cut))

dia.ex1gooder


```

---

**Question 2b: Now using your knowledge and understanding, make a good, clear graph worse.**

---

Copy and Paste your code here and edit accordingly
```{r}




```


---

**Question 3a: Within each of the following code examples, identify what each layer does within the graph**

---

1. Add Comments for each line in the function
```{r}
ggplot(data = diamonds,                    # input     diamonds data set
       mapping = aes(                      #
         x = price,                        #
         y = carat)) +                     # 
  geom_point() +                           #
  labs(                                    #
    x = "Price in USD",                    #
    y = "Carat of Diamond",                #
    title = "Price of Diamond per Carat")  #
 
```

2. Add Comments for each line in the function
```{r}
ggplot(data = diamonds,                   #
       mapping = aes(                     #
         x = price,                       #
         y = carat,                       #
         colour = clarity,                #
         shape = cut)) +                  #
  geom_point() +                          #
  labs(                                   #
    x = "Price in USD",                   #
    y = "Carat of Diamond",               #
    title = "Price of Diamond per Carat", #
    colour = "Diamond Clarity",           #
    shape = "Diamond Cut")  +             #
    theme_minimal()                       # Zorgt voor een witte achtergrond
```

---

**Question 3b: Using the previous examples as a basis, attempt to reproduce the plot in the HTML file**

---

Use this block to reproduce the graph
```{r}
head(mpg)
ggplot(data = mpg, 
       mapping = aes(x = cty, y = hwy, colour = cyl , shape = drv)) + 
  geom_point() + 
  labs(
    x = "Highway Miles per Gallon",
    y = "City miles per Gallon",
    title = "The Number of City miles per gallon, compared with the number of Highway miles per Gallon",
    colour = "Number of Cylinders", 
    shape = "Type of Drive") + 
  theme_minimal()



```

---

**Question 4: Using your previous knowledge of faceting and the examples above, change the following code examples so that it converts it from a complex scatter plot, to a series of faceted plots.**

---

Change this code accordingly:
```{r}
ggplot(data = msleep, 
       mapping = aes(x = sleep_rem, y = awake, colour = vore, size = brainwt)) + 
        geom_point() + 
        labs(x = "Amount of REM Sleep", y = "Amount of Time Spent Awake",
             title = "Amount of REM Sleep compared to the Time Spent Awake",
             colour = "Diet", size = "Brain Weight") +
        theme_minimal()

facetplots1 <- ggplot(data = msleep,
      mapping = aes(x = sleep_rem, y = awake, fl = vore, size = brainwt)) +
      geom_point() +
      facet_grid(vore~.)
facetplots1

myfacetplot <-ggplot(data = msleep, 
       mapping = aes(x = sleep_rem, y = awake, colour = vore, size = brainwt)) + 
        geom_point() + 
        labs(x = "Amount of REM Sleep", y = "Amount of Time Spent Awake",
             title = "Amount of REM Sleep compared to the Time Spent Awake",
             colour = "Diet", size = "Brain Weight") +
        theme_minimal() + facet_wrap(~vore) 
myfacetplot
```


---

**Question 5: Under each tab (in the HTML file), examine the different graphs produced using the same information, which best displays the information present.**

---

**Question 6: Follow the steps to plot the course of these stock prices over six months** 

---

Following the steps on HTML file, plot the data below.

  Step Zero:
```{r}
aapl.stk <-read_csv("https://www.nasdaq.com/api/v1/historical/AAPL/stocks/2019-10-16/2020-04-16")
csco.stk <- read_csv("https://www.nasdaq.com/api/v1/historical/CSCO/stocks/2019-10-16/2020-04-16")
fb.stk <- read_csv("https://www.nasdaq.com/api/v1/historical/FB/stocks/2019-10-16/2020-04-16")

```

  Step One
```{r}
# First we sub  the dollar sign for "" to make the values numeric

aapl.stk$`Close/Last` <- as.numeric(gsub("\\$", "",aapl.stk$`Close/Last`))
csco.stk$`Close/Last` <- as.numeric(gsub("\\$", "",csco.stk$`Close/Last`))
fb.stk$`Close/Last` <- as.numeric(gsub("\\$", "",fb.stk$`Close/Last`))

# Then we convert the Date data to actual date values
aapl.stk$Date<- as.Date(aapl.stk$Date,format='%m/%d/%y')
csco.stk$Date<- as.Date(csco.stk$Date,format='%m/%d/%y')
fb.stk$Date<- as.Date(fb.stk$Date,format='%m/%d/%y')

head(aapl.stk)
```

  Step Two
```{r}
aapl <- ggplot(data = aapl.stk,
               mapping = aes(x= Date, y = Volume)) + geom_line()
aapl
csco <- ggplot(data = csco.stk,
               mapping = aes(x= Date, y = Volume)) + geom_line()
csco

fb <- ggplot(data = fb.stk,
               mapping = aes(x= Date, y = Volume)) + geom_line()
fb

```

  Step Three & Four
```{r}
ggplot() + 
    geom_line(data = aapl.stk, mapping = aes(x= Date, y = Volume, color = "Apple")) + 
    geom_line(data = csco.stk, mapping = aes(x= Date, y = Volume, color="CSCO")) + 
    geom_line(data = fb.stk, mapping = aes(x= Date, y = Volume, color = "Facebook"))

```

---

**Question 7a: After exploring the huge amount of colour platettes available, use the provided template and change the scale colour.**

---

```{r}
install.packages("palettetown")
install.packages("ghibli")
library(palettetown)
library(ghibli)
ggplot(data = airquality, mapping = aes(x = Wind, y = Solar.R, colour = Temp)) +
  geom_point() + 
    scale_color_ghibli_c("SpiritedMedium")
```

--- 

**Question 7b: using the dataset midwest (from ggplot); produce a density plot which examines the density of a specific variable of your choosing, grouped by another variable from the dataset, using this information regarding colours for density plots.**

---

```{r}
midwest

midwestplot <- 
  ggplot(data = midwest, mapping = aes(x = popdensity, y = poptotal , shape = state ))+
  geom_point()+
  theme_minimal()+
  labs(shape = "State")

midwestplot
```

---

**Question 8: Using the dataset msleep, plot sleep_rem against awake, including brainwt as the size and vore as the shape**

---

```{r}
msleep
msleepplot <- ggplot(data= msleep, aes(x = sleep_rem, y = awake, size = brainwt, shape= vore, colour = genus))+
  geom_point()+ 
  labs(x = "sleep_rem",         # x-axis label
         y =  "awake",         # y-axis label
         shape = "Vore",     # shape legend label
         colour = "Genus",    # colour legend label
         title = "Shit" # title label
         )  


msleepplot

```

---

**Question 9a: Using the template provided, add in sufficient labels too all the data included**

---

```{r}
?mpg
ggplot(data = mpg, 
       mapping = aes(x = displ, y = cty, shape = drv, colour = fl)) +
    geom_point() + 
    theme_minimal() + labs(x = "Engine Displacement",         # x-axis label
         y = "Number of Cylinders",         # y-axis label
         shape = "Type of Drive Train",     # shape legend label
         colour = "Fuel Time",    # colour legend label
         title = "Fuel Economy Data 1999-2008"     # title label
         )  

```

---

**Question 9b: Using the stock graph you produced in Question 6, using annotate highlight a period of time (for example “2019-11-01” - “2020-01-01”) and a specific data (for example “2020-14-02”).**

---

```{r}
# Import the data
  sbux.stk <- read_csv("https://www.nasdaq.com/api/v1/historical/SBUX/stocks/2019-10-16/2020-04-16")
  amzn.stk <- read_csv("https://www.nasdaq.com/api/v1/historical/AMZN/stocks/2019-10-16/2020-04-16") 
  tsla.stk <- read_csv("https://www.nasdaq.com/api/v1/historical/TSLA/stocks/2019-10-16/2020-04-16") 
# Correct the data were appropriate 
  sbux.stk$`Close/Last` <- as.numeric(gsub("\\$", "", sbux.stk$`Close/Last`))
  amzn.stk$`Close/Last` <- as.numeric(gsub("\\$", "", amzn.stk$`Close/Last`))
  tsla.stk$`Close/Last` <- as.numeric(gsub("\\$", "", tsla.stk$`Close/Last`))

  sbux.stk$Date<- as.Date(sbux.stk$Date,format='%m/%d/%Y')
  amzn.stk$Date<- as.Date(amzn.stk$Date,format='%m/%d/%Y')
  tsla.stk$Date<- as.Date(tsla.stk$Date,format='%m/%d/%Y')
  
 tsla.stk
  
# Plot the Graph
  ggplot()+
    geom_line(data = sbux.stk, mapping = aes(x = `Date`, y = `Close/Last`, colour = 'red')) +
     geom_line(data = amzn.stk, mapping = aes(x = `Date`, y = `Close/Last`, colour = 'blue')) + 
     geom_line(data = tsla.stk, mapping = aes(x = `Date`, y = `Close/Last`, colour = 'green')) + 
    labs(x = "Date", y = "Price of Stock at Market Close ($)") + 
    scale_color_discrete(name ="Stock", labels = c("Starbucks (SBUX)","Amazon(AMZN)", "Tesla (TSLA)")) + # Add annotation in graph
    annotate(geom = "rect", xmin= as.Date("2019-12-01"), xmax = as.Date("2020-01-01"), 
             ymin = 0, ymax = 2500, fill = "red", alpha = 0.2) + 
    annotate(geom = "text", x = as.Date("2019-12-15"), y= 1000, label = "Winter \n 2020")


aapl.stk <-read_csv("https://www.nasdaq.com/api/v1/historical/AAPL/stocks/2019-10-16/2020-04-16")
csco.stk <- read_csv("https://www.nasdaq.com/api/v1/historical/CSCO/stocks/2019-10-16/2020-04-16")
fb.stk <- read_csv("https://www.nasdaq.com/api/v1/historical/FB/stocks/2019-10-16/2020-04-16")

# Then we convert the Date data to actual date values
aapl.stk$`Close/Last` <- as.numeric(gsub("\\$", "",aapl.stk$`Close/Last`))
csco.stk$`Close/Last` <- as.numeric(gsub("\\$", "",csco.stk$`Close/Last`))
fb.stk$`Close/Last` <- as.numeric(gsub("\\$", "",fb.stk$`Close/Last`))

aapl.stk$Date<- as.Date(aapl.stk$Date,format='%m/%d/%Y')
csco.stk$Date<- as.Date(csco.stk$Date,format='%m/%d/%Y')
fb.stk$Date<- as.Date(fb.stk$Date,format='%m/%d/%Y')

  
  ggplot() + 
    geom_line(data = aapl.stk, mapping = aes(x= `Date`, y = `Close/Last`, color = "red")) + 
    geom_line(data = csco.stk, mapping = aes(x= `Date`, y = `Close/Last`, color="blue")) + 
    geom_line(data = fb.stk, mapping = aes(x= `Date`, y = `Close/Last`, color = "green")) + 
    labs(x = "Date", y = "Price of Stock at Market Close ($)") + 
    scale_color_discrete(name ="Stock", labels = c("Starbucks (SBUX)","Amazon(AMZN)", "Tesla (TSLA)")) + 
    annotate(geom = "rect", xmin= as.Date("2020-03-01"), xmax = as.Date("2020-05-05"), 
             ymin = 0, ymax = 350, fill = "red", alpha = 0.2) + 
    annotate(geom = "text", x = as.Date("2020-04-01"), y= 100, label = "Big Rona")

```

---

**Question 10: Using all of the skills, templates and materials covered, as well as your own knowledge, using one of the following datasets available within ggplot, produce your own graph expressing some of the information within it.**

---

```{r}

```